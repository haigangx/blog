# fork系统调用

fork：Linux下创建新进程
#include <sys/types.h>
#include <unistd.h>
pid_t fork( void );
1、fork每次调用返回两次，父进程中返回子进程PID，子进程中返回0，fork调用失败返回-1并设置errno
2、fork函数复制当前进程，在内核进程表中创建了一个新的进程表项。新的进程表项有很多属性和原进程相同，比如堆指针、栈指针和标志寄存器的值。但也有许多属性被赋予了新的值，比如该进程的PPID被设置成原进程的PID，信号位图被清除(原进程设置的信号处理函数不再对新进程有效)
3、子进程的代码和父进程的代码相同，同时它还会复制父进程的数据(堆数据、栈数据和静态数据)。数据的复制采用的写时复制(copy on write)，即只有在任一进程(父或子进程)对数据执行了写操作，复制才会发生(先是缺页中断，然后操作系统给子进程分配内存并复制父进程的数据)
4、父进程中打开的文件描述符默认在子进程中也是打开的，且文件描述符的引用计数加1.不仅如此，父进程的用户根目录、当前工作目录等变量的引用计数均会加1
