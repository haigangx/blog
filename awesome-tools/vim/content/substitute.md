# substitute命令

substitute命令允许先查找一段文本，再用另一段文本将其替换掉。命令的语法如下：
```
:[range]s[ubstitute]/{pattern}/{string}/[flags]
```

## 一、范围`range`

| 范围 | 说明 | 备注 |
| --- | --- | --- |
| % | 全文替换 | |
| 1(2...n) | 在第1(2...n)行执行替换 |
| . | 在当前行执行替换 | .-1 光标所在行的上一行 |
| $ | 再最后一行执行替换 | $-1 倒数第二行，可以对某一行加减某个数值得到其他行 |
| n1,n2 | 对n1和n2之间的行执行替换 | |

## 二、查找域`{pattern}`

查找域为空时，vim将会重用上次的查找模式


## 三、替换域`{string}`

替换域为空时，vim将会用空的字符串替换每一处匹配，意即删除所有匹配

### 1. 替换域中的特殊字符

更多可以查询：`:h sub-replace-special`

| 符号 | 描述 |
| --- | --- |
| \r | 插入换行符 |
| \t | 制表符 |
| \\ | 反斜杠 |
| \1 \2 ... \9 | 插入第1(2 ... 9)个子匹配
| \0 | 插入匹配模式的所有内容 |
| & | 插入匹配模式的所有内容 |
| ~ | 使用上次调用:substitute时的{string} |
| \={Vim script} | 执行{Vim Script}表达式，并将返回的结果作为替换{string} |

## 四、标志位`flags`

| 标志位 | 说明 |
| --- | --- |
| g | 使得替换命令再全局范围内执行，既可以修改一行内所有匹配，而不仅仅是第一处匹配 |
| c | 可以确认和拒绝每一处修改 |
| n | 抑制正常的替换行为，即让vim不执行替换操作，而只是报告本次替换命令匹配的个数 |
| e | 如果没有匹配到该模式，标志位e用于屏蔽产生的"找不到该模式"的错误提示 |
| & | 指示vim重用上一次substitute命令所用过的标志位 |

## 五、实例

```
:%s/src/tag/g  #全文查找src替换为tag
```
